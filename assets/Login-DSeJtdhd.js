import{r as c,c as F,e as q,b as k,j as e,L as B}from"./index-D_Q_O0HY.js";import{F as s,s as o,a as E}from"./axios-CIxFNUha.js";import{S as W}from"./index-C4foNYjo.js";import{I as h}from"./index-Br1k9S-A.js";import{B as b}from"./button-D59xUyQy.js";import"./index-BiuuzBCp.js";const z=()=>{var p,x;const[f]=s.useForm(),[j,i]=c.useState(!1),[m,l]=c.useState(!1),[g,y]=c.useState(60),N=F(),v=q(),{login:w}=k(),C=((x=(p=v.state)==null?void 0:p.from)==null?void 0:x.pathname)||"/carts",I=async()=>{var t,r;try{const a=await f.validateFields(["phone","areaCode"]),{phone:n,areaCode:u}=a;if(!n||!u){o.warning("请输入手机号并选择区号！");return}l(!0),o.success("验证码已发送！"),await E.post("/api/send-code",{phone:n,areaCode:u});let d=60;const S=setInterval(()=>{d-=1,y(d),d===0&&(clearInterval(S),l(!1))},1e3)}catch(a){o.error(((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"验证码发送失败"),l(!1)}},L=async t=>{var r,a;i(!0);try{w(t.phone,t.areaCode),o.success("登录成功"),N(C,{replace:!0})}catch(n){o.error(((a=(r=n.response)==null?void 0:r.data)==null?void 0:a.message)||"请求出错")}finally{i(!1)}};return e.jsx("div",{className:"petti-login to-top",children:e.jsxs("div",{className:"flex justify-between w-default py-[80px]",children:[e.jsxs("section",{className:"w-[48%] p-[30px] border border-solid border-[#dadada] rounded-[2px]",children:[e.jsx("h1",{className:"text-[30px] mb-[20px] pb-[20px] border-b border-gray-300",children:"登录"}),e.jsxs(s,{name:"login",onFinish:L,layout:"vertical",children:[e.jsx(s.Item,{name:"areaCode",label:"地区",rules:[{required:!1,message:"请选择区号!"}],children:e.jsx(W,{className:"w-[30%]",placeholder:"区号",defaultValue:"+86",options:[{label:"+86 (中国)",value:"+86"}]})}),e.jsx(s.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号!"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确!"}],children:e.jsx(h,{placeholder:"输入手机号"})}),e.jsx(s.Item,{name:"code",label:"短信验证码",rules:[{required:!0,message:"请输入验证码!"}],children:e.jsxs("div",{className:"flex gap-2 align-bottom",children:[e.jsx(h,{placeholder:"输入验证码"}),e.jsx(b,{className:"petti-login-btn-code",disabled:m,onClick:()=>{s.useWatch("phone"),s.useWatch("areaCode"),I()},children:m?`${g}s 后重试`:"发送验证码"})]})}),e.jsx(s.Item,{children:e.jsx(b,{type:"primary",htmlType:"submit",loading:j,children:"登录"})})]})]}),e.jsxs("section",{className:"w-[48%] h-[330px] p-[30px] border border-solid border-[#dadada] rounded-[2px]",children:[e.jsx("h1",{className:"text-[30px] mb-[20px] pb-[20px] border-b border-gray-300",children:"新会员注册"}),e.jsx("h2",{className:"text-[#1b1b1b] mt-[40px]",children:"成为会员享受更多会员福利"}),e.jsx("div",{children:e.jsx(B,{to:"/register",children:e.jsx("button",{className:"mt-[40px] w-[80%] h-[52px] rounded-0 text-[18px] btn-common",children:"新会员注册"})})})]})]})})};export{z as default};
