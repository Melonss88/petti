import{r as c,j as e}from"./index-CQJzsA6F.js";import{F as r,s as o,a as p}from"./axios-i6itaSfj.js";import{S as v}from"./index-BWn-ncko.js";import{I as u}from"./index-Dg1awcGB.js";import{B as x}from"./button-D8RM3t08.js";import"./index-8Wi5Mc6I.js";const F=()=>{const[h,d]=c.useState(!1),[m,i]=c.useState(!1),[f,g]=c.useState(60),j=async(s,t)=>{var n,a;if(!s||!t){o.warning("请输入手机号并选择区号！");return}try{i(!0),o.success("验证码已发送！"),await p.post("/api/send-code",{phone:s,areaCode:t});let l=60;const b=setInterval(()=>{l-=1,g(l),l===0&&(clearInterval(b),i(!1))},1e3)}catch(l){o.error(((a=(n=l.response)==null?void 0:n.data)==null?void 0:a.message)||"验证码发送失败"),i(!1)}},y=async s=>{var t,n;console.log("提交数据:",s);try{d(!0);const a=await p.post("/api/login",s);a.data.success?(o.success("登录成功"),window.location.href="/"):o.error(a.data.message||"登录失败")}catch(a){o.error(((n=(t=a.response)==null?void 0:t.data)==null?void 0:n.message)||"请求出错")}finally{d(!1)}};return e.jsx("div",{className:"petti-register to-top",children:e.jsx("div",{className:"mt-[40px] flex justify-center",children:e.jsxs("div",{className:"text-center text-[20px] w-[500px]",children:[e.jsx("h1",{className:"mb-[60px]",children:"新用户注册"}),e.jsxs(r,{name:"login",onFinish:y,layout:"vertical",children:[e.jsx(r.Item,{name:"areaCode",label:"地区",rules:[{required:!0,message:"请选择区号!"}],children:e.jsx("div",{className:"",children:e.jsx(v,{placeholder:"区号",defaultValue:"+86",options:[{label:"+86 (中国)",value:"+86"}]})})}),e.jsx(r.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号!"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确!"}],children:e.jsx(u,{placeholder:"输入手机号"})}),e.jsx(r.Item,{name:"code",label:"短信验证码",rules:[{required:!0,message:"请输入验证码!"}],children:e.jsxs("div",{className:"flex gap-2 align-bottom",children:[e.jsx(u,{className:"",placeholder:"输入验证码"}),e.jsx(x,{className:"petti-login-btn-code",disabled:m,onClick:()=>{const s=r.useWatch("phone"),t=r.useWatch("areaCode");j(s,t)},children:m?`${f}s 后重试`:"发送验证码"})]})}),e.jsx(r.Item,{children:e.jsx(x,{type:"primary",htmlType:"submit",loading:h,children:"注册"})})]})]})})})};export{F as default};
